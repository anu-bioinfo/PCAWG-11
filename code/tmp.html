<h1 id="tree-distance">Tree distance</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(igraph)
<span class="kw">library</span>(CoxHD)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">toTree &lt;-<span class="st"> </span>function(edgelist, branch.length, labels){
    g &lt;-<span class="st"> </span><span class="kw">graph.edgelist</span>(edgelist)
    o &lt;-<span class="st"> </span><span class="kw">order</span>(<span class="kw">get.edgelist</span>(g)[,<span class="dv">2</span>])
    <span class="kw">E</span>(g)$weight[o] &lt;-<span class="st"> </span>branch.length
    <span class="kw">E</span>(g)$name[o] &lt;-<span class="st"> </span>labels
    <span class="kw">return</span>(g)   
}

toPhylo &lt;-<span class="st"> </span>function(edge, edge.length, labels){
    edge &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(edge)
    <span class="kw">dimnames</span>(edge) &lt;-<span class="st"> </span><span class="ot">NULL</span>
    all &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">c</span>(edge[,<span class="dv">1</span>], edge[,<span class="dv">2</span>]))
    tips &lt;-<span class="st"> </span><span class="kw">setdiff</span>(edge[,<span class="dv">2</span>],edge[,<span class="dv">1</span>])
    nodes &lt;-<span class="st"> </span><span class="kw">setdiff</span>(all, tips)
    order &lt;-<span class="st"> </span><span class="kw">c</span>(tips, nodes)
    o &lt;-<span class="st"> </span><span class="kw">order</span>(order)
    l &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">edge=</span><span class="kw">cbind</span>(o[edge[,<span class="dv">1</span>]],o[edge[,<span class="dv">2</span>]]), <span class="dt">edge.length=</span>edge.length, <span class="dt">Nnode=</span><span class="kw">length</span>(nodes), <span class="dt">tip.label=</span>labels[tips], <span class="dt">node.labels=</span>labels[nodes])
    <span class="kw">class</span>(l) &lt;-<span class="st"> &quot;phylo&quot;</span>
    <span class="kw">attr</span>(l, <span class="st">&quot;order&quot;</span>) &lt;-<span class="st"> &quot;cladewise&quot;</span>
    <span class="kw">return</span>(l)
}

<span class="co">#tree &lt;- list(`1`=2,`2`=c(3,4),`3`=5:7)</span></code></pre>
<h1 id="read-data">Read data</h1>
<pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;BRCA.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)
<span class="kw">kable</span>(data)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Sample</th>
<th align="right">Parent</th>
<th align="right">Child</th>
<th align="left">Annotation</th>
<th align="right">Length</th>
<th align="right">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PD9775</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">TP53</td>
<td align="right">0.95</td>
<td align="right">3104</td>
</tr>
<tr class="even">
<td align="left">PD9775</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="left"></td>
<td align="right">0.05</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">PD9773</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">TP53;ARID1B</td>
<td align="right">0.95</td>
<td align="right">2036</td>
</tr>
<tr class="even">
<td align="left">PD9773</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="left"></td>
<td align="right">0.05</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">PD9776</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">PTEN;ARID1B;MYC;FGFR2;17p-;BRCA1</td>
<td align="right">0.95</td>
<td align="right">13219</td>
</tr>
<tr class="even">
<td align="left">PD9776</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">MYC</td>
<td align="right">0.05</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">PD9776</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="left"></td>
<td align="right">0.05</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">PD9777</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">TP53;CBL;JAK2;17p-</td>
<td align="right">0.80</td>
<td align="right">4851</td>
</tr>
<tr class="odd">
<td align="left">PD9777</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="left"></td>
<td align="right">0.05</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">PD9777</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="left">FGFR2;MYC</td>
<td align="right">0.05</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">PD9777</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="left">FGFR2</td>
<td align="right">0.05</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">PD9777</td>
<td align="right">4</td>
<td align="right">5</td>
<td align="left"></td>
<td align="right">0.05</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">PD9769</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">TP53;CTNNB1;PTEN;MYC;CCNE1;17p-</td>
<td align="right">0.70</td>
<td align="right">6582</td>
</tr>
<tr class="even">
<td align="left">PD9769</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">RUNX1</td>
<td align="right">0.20</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">PD9769</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="left"></td>
<td align="right">0.10</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">PD9769</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="left">IGF2R;RUNX1</td>
<td align="right">0.20</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">PD9771</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">TP53;FGFR1;WHSC1L1;ERLIN2;IGF1R;CDK4;AR;MET;17p-</td>
<td align="right">0.70</td>
<td align="right">11479</td>
</tr>
<tr class="even">
<td align="left">PD9771</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">NRAS;CDKN2B</td>
<td align="right">0.05</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">PD9771</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="left">CIC</td>
<td align="right">0.10</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">PD9771</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">RAD21;NCOR</td>
<td align="right">0.20</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">PD9771</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="left"></td>
<td align="right">0.05</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">PD9771</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left"></td>
<td align="right">0.05</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">PD9770</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">TP53;PIK3CA;EGFR</td>
<td align="right">0.40</td>
<td align="right">7624</td>
</tr>
<tr class="even">
<td align="left">PD9770</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">EGFR;NRG1;CDC7</td>
<td align="right">0.45</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">PD9770</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="left">CDK6;CUX1;3p-</td>
<td align="right">0.40</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">PD9770</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="left">CUX1</td>
<td align="right">0.20</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">PD9770</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="left">ERBB2</td>
<td align="right">0.20</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">PD9849</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">TP53;PTEN;FGFR2;ERLIN2;WHSC1L1;FGFR1;17p-</td>
<td align="right">0.90</td>
<td align="right">4212</td>
</tr>
<tr class="odd">
<td align="left">PD9849</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">CBFB</td>
<td align="right">0.05</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">PD9849</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="left"></td>
<td align="right">0.10</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">PD9849</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="left"></td>
<td align="right">0.05</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">PD9852</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">TP53;PIK3CA;PBRM1;NF1;EGFR;ERBB2;17p-</td>
<td align="right">0.85</td>
<td align="right">6231</td>
</tr>
<tr class="odd">
<td align="left">PD9852</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="left"></td>
<td align="right">0.10</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">PD9852</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="left">PBRM1</td>
<td align="right">0.15</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">PD9694</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">SF3B1;CREBBP;PTEN</td>
<td align="right">0.20</td>
<td align="right">3371</td>
</tr>
<tr class="even">
<td align="left">PD9694</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">BMX;FGFR1;AKT3</td>
<td align="right">0.40</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">PD9694</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="left">PTEN</td>
<td align="right">0.40</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">PD9694</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="left"></td>
<td align="right">0.10</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">PD9694</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="left">TERT</td>
<td align="right">0.20</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">PD9694</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="left"></td>
<td align="right">0.60</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>Split</p>
<pre class="sourceCode r"><code class="sourceCode r">dataList &lt;-<span class="st"> </span><span class="kw">split</span>(data, data$Sample)</code></pre>
<h1 id="create-tree-structurs">Create tree structurs</h1>
<pre class="sourceCode r"><code class="sourceCode r">allTrees &lt;-<span class="st"> </span><span class="kw">lapply</span>(dataList, function(x){   
            <span class="kw">toTree</span>(<span class="kw">as.matrix</span>(x[,<span class="kw">c</span>(<span class="st">&quot;Parent&quot;</span>,<span class="st">&quot;Child&quot;</span>)])+<span class="dv">1</span>, <span class="dt">branch.length =</span> x$Length, <span class="dt">labels=</span><span class="kw">as.character</span>(x$Annotation))
})
<span class="kw">names</span>(allTrees) &lt;-<span class="st"> </span><span class="kw">names</span>(dataList)
i &lt;-<span class="st"> </span><span class="dv">1</span>; for(tree in allTrees){
    <span class="kw">plot</span>(tree, <span class="dt">layout=</span><span class="kw">layout.reingold.tilford</span>(tree), <span class="dt">main=</span><span class="kw">names</span>(allTrees)[i], <span class="dt">edge.label=</span><span class="kw">E</span>(tree)$name); i&lt;-i<span class="dv">+1</span>}</code></pre>
<p><img src="figure/trees1.png" alt="plot of chunk trees" /> <img src="figure/trees2.png" alt="plot of chunk trees" /> <img src="figure/trees3.png" alt="plot of chunk trees" /> <img src="figure/trees4.png" alt="plot of chunk trees" /> <img src="figure/trees5.png" alt="plot of chunk trees" /> <img src="figure/trees6.png" alt="plot of chunk trees" /> <img src="figure/trees7.png" alt="plot of chunk trees" /> <img src="figure/trees8.png" alt="plot of chunk trees" /> <img src="figure/trees9.png" alt="plot of chunk trees" /> <img src="figure/trees10.png" alt="plot of chunk trees" /></p>
<h1 id="compute-distance-of-nodes">Compute distance of nodes</h1>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">shortest.paths</span>(allTrees$PD9694, <span class="dt">mode=</span><span class="st">&quot;out&quot;</span>) <span class="co"># example</span></code></pre>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]    0  0.2  0.6  1.0  0.7  0.4  1.0
## [2,]  Inf  0.0  0.4  0.8  0.5  0.2  0.8
## [3,]  Inf  Inf  0.0  0.4  0.1  Inf  Inf
## [4,]  Inf  Inf  Inf  0.0  Inf  Inf  Inf
## [5,]  Inf  Inf  Inf  Inf  0.0  Inf  Inf
## [6,]  Inf  Inf  Inf  Inf  Inf  0.0  0.6
## [7,]  Inf  Inf  Inf  Inf  Inf  Inf  0.0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">allDist &lt;-<span class="st"> </span><span class="kw">sapply</span>(allTrees, function(tree){ <span class="co">#all</span>
            e &lt;-<span class="st"> </span><span class="kw">get.edgelist</span>(tree)
            w &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">E</span>(tree)$weight/<span class="dv">2</span>)
            d &lt;-<span class="st"> </span><span class="kw">shortest.paths</span>(tree, <span class="dt">mode=</span><span class="st">&#39;out&#39;</span>) -<span class="st"> </span><span class="kw">rep</span>(w, <span class="dt">each=</span><span class="kw">length</span>(w))
            <span class="kw">diag</span>(d) &lt;-<span class="st"> </span><span class="ot">NA</span>
            d
        })</code></pre>
<h1 id="get-all-mutations">Get all mutations</h1>
<pre class="sourceCode r"><code class="sourceCode r">u &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">strsplit</span>(<span class="kw">as.character</span>(data$Annotation), <span class="st">&quot;;&quot;</span>))
<span class="kw">table</span>(u)</code></pre>
<pre><code>## u
##    17p-     3p-    AKT3      AR  ARID1B     BMX   BRCA1    CBFB     CBL 
##       6       1       1       1       2       1       1       1       1 
##   CCNE1    CDC7    CDK4    CDK6  CDKN2B     CIC  CREBBP  CTNNB1    CUX1 
##       1       1       1       1       1       1       1       1       2 
##    EGFR   ERBB2  ERLIN2   FGFR1   FGFR2   IGF1R   IGF2R    JAK2     MET 
##       3       2       2       3       4       1       1       1       1 
##     MYC    NCOR     NF1    NRAS    NRG1   PBRM1  PIK3CA    PTEN   RAD21 
##       4       1       1       1       1       2       2       5       1 
##   RUNX1   SF3B1    TERT    TP53 WHSC1L1 
##       2       1       1       8       2</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">allMutations &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(u))
allMutationsGermline &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;germline&quot;</span>,allMutations)</code></pre>
<h1 id="put-into-large-array">Put into large array</h1>
<pre class="sourceCode r"><code class="sourceCode r">allDistMutations &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="kw">c</span>(<span class="kw">rep</span>(<span class="kw">length</span>(allMutationsGermline),<span class="dv">2</span>), <span class="kw">length</span>(dataList)), <span class="dt">dimnames=</span><span class="kw">list</span>(allMutationsGermline, allMutationsGermline, <span class="kw">names</span>(dataList)))
for(n in <span class="kw">names</span>(dataList)){
    m &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">germline=</span><span class="dv">1</span>,<span class="kw">sapply</span>(allMutations, function(x) {g &lt;-<span class="st"> </span><span class="kw">grep</span>(x, dataList[[n]]$Annotation); if(<span class="kw">length</span>(g)==<span class="dv">0</span>) <span class="ot">NA</span> else g[<span class="dv">1</span>]+<span class="dv">1</span>}))
    d &lt;-<span class="st"> </span>allDist[[n]][m,m]
    <span class="co">#d[is.infinite(d)] &lt;- NA</span>
    allDistMutations[,,n] &lt;-<span class="st"> </span>d
}

weights &lt;-<span class="st"> </span><span class="kw">sapply</span>(dataList, function(x){
                m &lt;-<span class="st"> </span><span class="kw">sapply</span>(allMutations, function(y) {g &lt;-<span class="st"> </span><span class="kw">grep</span>(y, x$Annotation); if(<span class="kw">length</span>(g)==<span class="dv">0</span>) <span class="ot">NA</span> else g[<span class="dv">1</span>]})
                <span class="dv">1</span>/x$Length[m]
        })
<span class="kw">rownames</span>(weights) &lt;-<span class="st"> </span>allMutations</code></pre>
<h1 id="fit-model">Fit model</h1>
<pre class="sourceCode r"><code class="sourceCode r">observed &lt;-<span class="st"> </span>!<span class="kw">is.na</span>(allDistMutations) &amp;<span class="st"> </span>!<span class="kw">is.infinite</span>(allDistMutations) &amp;<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="kw">rep</span>(<span class="ot">FALSE</span>, <span class="kw">length</span>(allMutations))) <span class="co"># only distance to root for the moment..</span>
w &lt;-<span class="st"> </span><span class="kw">which</span>(observed, <span class="dt">arr.ind =</span> <span class="ot">TRUE</span>)
y &lt;-<span class="st"> </span>allDistMutations[observed]
x &lt;-<span class="st"> </span><span class="kw">MakeInteger</span>(<span class="kw">factor</span>(w[,<span class="dv">2</span>], <span class="dt">levels=</span><span class="kw">seq_along</span>(allMutationsGermline), <span class="dt">labels=</span>allMutationsGermline)) -<span class="st"> </span><span class="kw">MakeInteger</span>(<span class="kw">factor</span>(w[,<span class="dv">1</span>], <span class="dt">levels=</span><span class="kw">seq_along</span>(allMutationsGermline), <span class="dt">labels=</span>allMutationsGermline))

fit &lt;-<span class="st"> </span><span class="kw">lm</span>(y ~<span class="st"> </span>. -<span class="dv">1</span> -germline, <span class="dt">data=</span>x , <span class="dt">weights=</span><span class="dv">1</span>/<span class="kw">mapply</span>(function(i,j) weights[i,j], w[,<span class="dv">2</span>]-<span class="dv">1</span>,w[,<span class="dv">3</span>]))
s &lt;-<span class="st"> </span><span class="kw">summary</span>(fit)
<span class="kw">kable</span>(s$coefficients)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">Std. Error</th>
<th align="right">t value</th>
<th align="right">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>17p-</code></td>
<td align="right">0.4138</td>
<td align="right">0.0355</td>
<td align="right">11.6585</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left"><code>3p-</code></td>
<td align="right">0.6000</td>
<td align="right">0.1242</td>
<td align="right">4.8301</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td align="left">AKT3</td>
<td align="right">0.4000</td>
<td align="right">0.1242</td>
<td align="right">3.2201</td>
<td align="right">0.0032</td>
</tr>
<tr class="even">
<td align="left">AR</td>
<td align="right">0.4413</td>
<td align="right">0.0487</td>
<td align="right">9.0582</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td align="left">ARID1B</td>
<td align="right">0.4750</td>
<td align="right">0.0570</td>
<td align="right">8.3339</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left">BMX</td>
<td align="right">0.4000</td>
<td align="right">0.1242</td>
<td align="right">3.2201</td>
<td align="right">0.0032</td>
</tr>
<tr class="odd">
<td align="left">BRCA1</td>
<td align="right">0.4750</td>
<td align="right">0.0806</td>
<td align="right">5.8930</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left">CBFB</td>
<td align="right">0.9250</td>
<td align="right">0.3513</td>
<td align="right">2.6327</td>
<td align="right">0.0134</td>
</tr>
<tr class="odd">
<td align="left">CBL</td>
<td align="right">0.4000</td>
<td align="right">0.0878</td>
<td align="right">4.5539</td>
<td align="right">0.0001</td>
</tr>
<tr class="even">
<td align="left">CCNE1</td>
<td align="right">0.3500</td>
<td align="right">0.0939</td>
<td align="right">3.7273</td>
<td align="right">0.0008</td>
</tr>
<tr class="odd">
<td align="left">CDC7</td>
<td align="right">0.6250</td>
<td align="right">0.1171</td>
<td align="right">5.3366</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left">CDK4</td>
<td align="right">0.3500</td>
<td align="right">0.0939</td>
<td align="right">3.7273</td>
<td align="right">0.0008</td>
</tr>
<tr class="odd">
<td align="left">CDK6</td>
<td align="right">0.6000</td>
<td align="right">0.1242</td>
<td align="right">4.8301</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left">CDKN2B</td>
<td align="right">0.7250</td>
<td align="right">0.3513</td>
<td align="right">2.0635</td>
<td align="right">0.0481</td>
</tr>
<tr class="odd">
<td align="left">CIC</td>
<td align="right">0.7500</td>
<td align="right">0.2484</td>
<td align="right">3.0188</td>
<td align="right">0.0052</td>
</tr>
<tr class="even">
<td align="left">CREBBP</td>
<td align="right">0.1000</td>
<td align="right">0.1757</td>
<td align="right">0.5692</td>
<td align="right">0.5736</td>
</tr>
<tr class="odd">
<td align="left">CTNNB1</td>
<td align="right">0.3500</td>
<td align="right">0.0939</td>
<td align="right">3.7273</td>
<td align="right">0.0008</td>
</tr>
<tr class="even">
<td align="left">CUX1</td>
<td align="right">0.6000</td>
<td align="right">0.1242</td>
<td align="right">4.8301</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td align="left">EGFR</td>
<td align="right">0.3530</td>
<td align="right">0.0703</td>
<td align="right">5.0235</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left">ERBB2</td>
<td align="right">0.5155</td>
<td align="right">0.0767</td>
<td align="right">6.7233</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td align="left">ERLIN2</td>
<td align="right">0.4062</td>
<td align="right">0.0621</td>
<td align="right">6.5408</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left">FGFR1</td>
<td align="right">0.4050</td>
<td align="right">0.0556</td>
<td align="right">7.2903</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td align="left">FGFR2</td>
<td align="right">0.4737</td>
<td align="right">0.0570</td>
<td align="right">8.3108</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left">IGF1R</td>
<td align="right">0.3500</td>
<td align="right">0.0939</td>
<td align="right">3.7273</td>
<td align="right">0.0008</td>
</tr>
<tr class="odd">
<td align="left">IGF2R</td>
<td align="right">0.8000</td>
<td align="right">0.1757</td>
<td align="right">4.5539</td>
<td align="right">0.0001</td>
</tr>
<tr class="even">
<td align="left">JAK2</td>
<td align="right">0.4000</td>
<td align="right">0.0878</td>
<td align="right">4.5539</td>
<td align="right">0.0001</td>
</tr>
<tr class="odd">
<td align="left">MET</td>
<td align="right">0.3500</td>
<td align="right">0.0939</td>
<td align="right">3.7273</td>
<td align="right">0.0008</td>
</tr>
<tr class="even">
<td align="left">MYC</td>
<td align="right">0.4353</td>
<td align="right">0.0603</td>
<td align="right">7.2241</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td align="left">NCOR</td>
<td align="right">0.9000</td>
<td align="right">0.1757</td>
<td align="right">5.1231</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left">NF1</td>
<td align="right">0.4250</td>
<td align="right">0.0852</td>
<td align="right">4.9874</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td align="left">NRAS</td>
<td align="right">0.7250</td>
<td align="right">0.3513</td>
<td align="right">2.0635</td>
<td align="right">0.0481</td>
</tr>
<tr class="even">
<td align="left">NRG1</td>
<td align="right">0.6250</td>
<td align="right">0.1171</td>
<td align="right">5.3366</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td align="left">PBRM1</td>
<td align="right">0.4250</td>
<td align="right">0.0852</td>
<td align="right">4.9874</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left">PIK3CA</td>
<td align="right">0.3530</td>
<td align="right">0.0703</td>
<td align="right">5.0235</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td align="left">PTEN</td>
<td align="right">0.4077</td>
<td align="right">0.0474</td>
<td align="right">8.6063</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left">RAD21</td>
<td align="right">0.9000</td>
<td align="right">0.1757</td>
<td align="right">5.1231</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td align="left">RUNX1</td>
<td align="right">0.8000</td>
<td align="right">0.1757</td>
<td align="right">4.5539</td>
<td align="right">0.0001</td>
</tr>
<tr class="even">
<td align="left">SF3B1</td>
<td align="right">0.1000</td>
<td align="right">0.1757</td>
<td align="right">0.5692</td>
<td align="right">0.5736</td>
</tr>
<tr class="odd">
<td align="left">TERT</td>
<td align="right">0.3000</td>
<td align="right">0.1757</td>
<td align="right">1.7077</td>
<td align="right">0.0984</td>
</tr>
<tr class="even">
<td align="left">TP53</td>
<td align="right">0.4094</td>
<td align="right">0.0314</td>
<td align="right">13.0276</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td align="left">WHSC1L1</td>
<td align="right">0.4062</td>
<td align="right">0.0621</td>
<td align="right">6.5408</td>
<td align="right">0.0000</td>
</tr>
</tbody>
</table>
<h1 id="plot">Plot</h1>
<pre class="sourceCode r"><code class="sourceCode r">r &lt;-<span class="st"> </span><span class="kw">rank</span>(<span class="kw">coef</span>(fit), <span class="dt">ties.method =</span> <span class="st">&#39;random&#39;</span>)
c &lt;-<span class="st"> </span><span class="kw">coef</span>(fit)
<span class="kw">par</span>(<span class="dt">bty=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xpd=</span><span class="ot">NA</span>, <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>))
<span class="kw">plot</span>(c, r, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">xlab=</span><span class="st">&quot;relative time&quot;</span>, <span class="dt">yaxt=</span><span class="st">&#39;n&#39;</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span><span class="kw">sqrt</span>(<span class="kw">table</span>(u)[<span class="kw">gsub</span>(<span class="st">&quot;`&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="kw">names</span>(r))]/<span class="dv">2</span>))
v1 &lt;-<span class="st"> </span>s$coefficients[,<span class="dv">2</span>]^<span class="dv">2</span>
d1 &lt;-<span class="st"> </span><span class="kw">colSums</span>(<span class="kw">abs</span>(x[,-<span class="dv">1</span>]))
d0 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># prior df</span>
v0 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># prior variance, i.e., any time</span>
v &lt;-<span class="st"> </span>(d1*v1 +<span class="st"> </span>d0 *<span class="st"> </span>v0)/(d0+d1)  
sd &lt;-<span class="st"> </span><span class="kw">sqrt</span>(v)
<span class="kw">segments</span>(<span class="kw">pmax</span>(<span class="dv">0</span>,c-sd),r, <span class="kw">pmin</span>(<span class="dv">1</span>,c+sd),r)
<span class="kw">text</span>(<span class="kw">pmin</span>(<span class="dv">1</span>,c+sd),r, <span class="kw">paste0</span>(<span class="kw">names</span>(c), <span class="st">&quot;, n=&quot;</span>,<span class="kw">table</span>(u)), <span class="dt">pos=</span><span class="dv">4</span>)</code></pre>
<div class="figure">
<img src="figure/unnamed-chunk-5.png" alt="plot of chunk unnamed-chunk-5" /><p class="caption">plot of chunk unnamed-chunk-5</p>
</div>
